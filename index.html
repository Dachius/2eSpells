<!DOCTYPE html>
<html lang="en">
    <head>
        <title>2e Spell List</title>
        <style type="text/css">
            :root {
                color-scheme: dark;
                width: 100%;
                height: 100%;
            }
            #viewportWrapper {
                position: relative;
                width: 100%;
                height: 100%;
            }
            #headerWrapper {
                position: relative;
                width: 94%;
                padding: 3%;
                height: 9%;
                color:white;
            }
            #contentWrapper {
                position: relative;
                margin: 3% 0 3% 3%;
            }
            #listWrapper {
                display:inline-block;
                vertical-align:top;
                max-width:30%;
            }
            #infoWrapper {
                display:inline-block;
                vertical-align:top;
                width: 65%;
                margin-left: 2%;
            }
            .infoTable {
                width: 100%;
                border-collapse:collapse;
            }
            .infoData{
                color:rgb(187, 187, 187);
            }
            #Name {
                color: #d29a38;
                font-size: 1.8em;
                font-family: times new roman,serif;
                font-variant: small-caps;
                font-weight: 500;
            }
            #Duration {
                border-bottom:2px solid#d29a38
            }
        </style>
    </head>
    <body style="background-color:rgb(24, 26, 27)">
        <div id="viewportWrapper">
            <div id="headerWrapper">
                <div>
                    AD&D 2e spell sorter. Click on a row in the table for more information on a spell.
                </div>
                <button type="button" onClick="makeFilter(1)">Level 1</button>
            </div>
            <div id="contentWrapper" id="content">
                <div id="listWrapper"></div>
                <div id="infoWrapper">
                    <table id="infoTable">
                        <tbody>
                            <tr><td class="infoData" id="Name"></td></tr>
                            <tr><td class="infoData" id="Level&School"></td></tr>
                            <tr><td class="infoData" id="CastingTime"></td></tr>
                            <tr><td class="infoData" id="Range"></td></tr>
                            <tr><td class="infoData" id="Components"></td></tr>
                            <tr><td class="infoData" id="Duration"></td></tr>
                            <tr><td class="infoData" id="Description"></td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </body>

    <link href="tabulator/css/tabulator_midnight.css" rel="stylesheet">
    <script type="text/javascript" src="tabulator/js/tabulator.min.js"></script>
        
    <script>
        wizardTable();

        var table;
        
        async function wizardTable(){
            const response = await fetch('json/wizard.json')
            var wizardData = await response.json();
            table = new Tabulator("#listWrapper", {
                data:wizardData, //assign data to table
                height:"75vh",
                layout:"fitDataTable",
                columns:[
                    {title:"Lvl", field:"level", sorter:"number"},
                    {title:"Name", field:"name", sorter:"alphanum"},
                    {title:"School", field:"school", sorter:"alphanum"}
                ]
            });
            
            table.on("rowClick", function(e, row){drawInfoBox(e, row);});
        }

        function drawInfoBox(e, row){
            var data = row.getData();
            document.getElementById("Name").innerHTML = data.name;
            document.getElementById("Level&School").innerHTML = "Level " + data.level + " " + data.school;
            document.getElementById("CastingTime").innerHTML = "<strong>Casting Time:</strong> " + data.castingTime;
            document.getElementById("Range").innerHTML = "<strong>Range:</strong> " + data.range;
            document.getElementById("Components").innerHTML = data.name;
            document.getElementById("Duration").innerHTML = "<strong>Duration:</strong> " + data.duration;
            document.getElementById("Description").innerText = data.description;
        }

        function makeFilter(param){
            table.setFilter("name", "=", "Leomund's Hidden Lodge");
        }
    </script>
</html>
